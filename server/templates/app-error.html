<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Error Alert</title>
</head>
<body style="margin:0;padding:0;font-family:'Consolas','Monaco','Courier New',monospace;background:#1E1E1E;color:#D4D4D4;">
    <div style="max-width:100%;background:#1E1E1E;padding:40px 20px;">
        <div style="max-width:700px;margin:0 auto;background:#2D2D30;border-radius:8px;overflow:hidden;border:1px solid #3E3E42;">
            
            <!-- Header -->
            <div style="background:#C72E29;padding:20px 25px;">
                <h1 style="color:white;margin:0;font-size:20px;font-weight:normal;display:flex;align-items:center;">
                    ⚠️ Application Error Detected
                </h1>
                <p style="color:#FFD7D7;margin:8px 0 0 0;font-size:13px;">
                    {{timestamp}}
                </p>
            </div>

            <!-- Error Details -->
            <div style="padding:25px;">
                
                <!-- Error Summary -->
                <div style="background:#1E1E1E;border-radius:6px;padding:20px;margin-bottom:20px;border:1px solid #464647;">
                    <table style="width:100%;border:0;border-spacing:0;">
                        <tr>
                            <td style="padding:5px 0;color:#858585;font-size:13px;vertical-align:top;width:120px;">
                                Environment:
                            </td>
                            <td style="padding:5px 0;color:#CE9178;font-size:13px;">
                                {{environment}}
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:5px 0;color:#858585;font-size:13px;vertical-align:top;">
                                Error Type:
                            </td>
                            <td style="padding:5px 0;color:#F48771;font-size:13px;font-weight:bold;">
                                {{errorType}}
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:5px 0;color:#858585;font-size:13px;vertical-align:top;">
                                Service:
                            </td>
                            <td style="padding:5px 0;color:#9CDCFE;font-size:13px;">
                                {{service}}
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:5px 0;color:#858585;font-size:13px;vertical-align:top;">
                                Severity:
                            </td>
                            <td style="padding:5px 0;font-size:13px;">
                                {{#if critical}}
                                <span style="background:#D73A49;color:white;padding:2px 8px;border-radius:3px;font-size:11px;">CRITICAL</span>
                                {{else if high}}
                                <span style="background:#FB8500;color:white;padding:2px 8px;border-radius:3px;font-size:11px;">HIGH</span>
                                {{else if medium}}
                                <span style="background:#F4B643;color:#1E1E1E;padding:2px 8px;border-radius:3px;font-size:11px;">MEDIUM</span>
                                {{else}}
                                <span style="background:#608B4E;color:white;padding:2px 8px;border-radius:3px;font-size:11px;">LOW</span>
                                {{/if}}
                            </td>
                        </tr>
                        {{#if endpoint}}
                        <tr>
                            <td style="padding:5px 0;color:#858585;font-size:13px;vertical-align:top;">
                                Endpoint:
                            </td>
                            <td style="padding:5px 0;color:#DCDCAA;font-size:13px;font-family:monospace;">
                                {{method}} {{endpoint}}
                            </td>
                        </tr>
                        {{/if}}
                        {{#if userId}}
                        <tr>
                            <td style="padding:5px 0;color:#858585;font-size:13px;vertical-align:top;">
                                User ID:
                            </td>
                            <td style="padding:5px 0;color:#B5CEA8;font-size:13px;">
                                {{userId}}
                            </td>
                        </tr>
                        {{/if}}
                    </table>
                </div>

                <!-- Error Message -->
                <div style="background:#1E1E1E;border-radius:6px;padding:20px;margin-bottom:20px;border-left:3px solid #F48771;">
                    <h3 style="color:#F48771;font-size:14px;margin:0 0 10px 0;font-weight:normal;">
                        Error Message:
                    </h3>
                    <p style="color:#D4D4D4;font-size:13px;line-height:1.5;margin:0;word-break:break-all;">
                        {{errorMessage}}
                    </p>
                </div>

                <!-- Stack Trace -->
                {{#if stackTrace}}
                <div style="background:#1E1E1E;border-radius:6px;padding:20px;margin-bottom:20px;border:1px solid #464647;">
                    <h3 style="color:#858585;font-size:14px;margin:0 0 10px 0;font-weight:normal;">
                        Stack Trace:
                    </h3>
                    <pre style="color:#D4D4D4;font-size:12px;line-height:1.4;margin:0;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word;">{{stackTrace}}</pre>
                </div>
                {{/if}}

                <!-- Request Context -->
                {{#if requestData}}
                <div style="background:#1E1E1E;border-radius:6px;padding:20px;margin-bottom:20px;border:1px solid #464647;">
                    <h3 style="color:#858585;font-size:14px;margin:0 0 10px 0;font-weight:normal;">
                        Request Context:
                    </h3>
                    <pre style="color:#9CDCFE;font-size:12px;line-height:1.4;margin:0;overflow-x:auto;">{{requestData}}</pre>
                </div>
                {{/if}}

                <!-- Metrics -->
                {{#if metrics}}
                <div style="background:#1E1E1E;border-radius:6px;padding:15px;margin-bottom:20px;border:1px solid #464647;">
                    <table style="width:100%;border:0;border-spacing:0;">
                        <tr>
                            <td style="padding:5px 10px;color:#858585;font-size:12px;text-align:center;border-right:1px solid #464647;">
                                <div style="color:#F48771;font-size:20px;font-weight:bold;">{{metrics.errorCount}}</div>
                                <div>Errors Today</div>
                            </td>
                            <td style="padding:5px 10px;color:#858585;font-size:12px;text-align:center;border-right:1px solid #464647;">
                                <div style="color:#F4B643;font-size:20px;font-weight:bold;">{{metrics.affectedUsers}}</div>
                                <div>Affected Users</div>
                            </td>
                            <td style="padding:5px 10px;color:#858585;font-size:12px;text-align:center;">
                                <div style="color:#9CDCFE;font-size:20px;font-weight:bold;">{{metrics.frequency}}</div>
                                <div>Frequency</div>
                            </td>
                        </tr>
                    </table>
                </div>
                {{/if}}

                <!-- Action Buttons -->
                <div style="text-align:center;margin:25px 0;">
                    <a href="{{logsUrl}}" style="display:inline-block;background:#007ACC;color:white;padding:10px 24px;border-radius:4px;text-decoration:none;font-size:13px;margin:0 10px 10px 0;">
                        View Full Logs
                    </a>
                    <a href="{{dashboardUrl}}" style="display:inline-block;background:#3E3E42;color:#D4D4D4;padding:10px 24px;border-radius:4px;text-decoration:none;font-size:13px;border:1px solid #464647;">
                        Open Dashboard
                    </a>
                </div>

                <!-- Suggested Actions -->
                {{#if suggestedActions}}
                <div style="background:#252526;border-radius:6px;padding:15px;border:1px solid #464647;">
                    <h4 style="color:#608B4E;font-size:13px;margin:0 0 10px 0;">Suggested Actions:</h4>
                    <ul style="color:#D4D4D4;font-size:12px;line-height:1.8;margin:0;padding-left:20px;">
                        {{#each suggestedActions}}
                        <li>{{this}}</li>
                        {{/each}}
                    </ul>
                </div>
                {{/if}}

            </div>

            <!-- Footer -->
            <div style="background:#252526;padding:15px 25px;border-top:1px solid #464647;">
                <p style="color:#858585;font-size:11px;margin:0;text-align:center;">
                    Error ID: <span style="color:#9CDCFE;font-family:monospace;">{{errorId}}</span><br>
                    Generated by Under It All Error Monitoring System
                </p>
            </div>

        </div>
    </div>
</body>
</html>