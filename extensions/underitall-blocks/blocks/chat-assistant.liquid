{% comment %}
  UnderItAll Chat Assistant Block
  Embeds the AI-powered chat bubble into the Shopify theme
{% endcomment %}

{{ 'chat-block.css' | asset_url | stylesheet_tag }}

{% if block.settings.enabled %}
<div id="underitall-chat-root"
     data-api-url="{{ block.settings.api_url }}"
     data-position="{{ block.settings.position }}">
  <script>
    // Global config for chat bundle
    window.UNDERITALL_CHAT_CONFIG = {
      apiUrl: "{{ block.settings.api_url }}",
      position: "{{ block.settings.position }}",
      enabled: {{ block.settings.enabled }}
    };
  </script>
</div>

<script src="{{ 'chat-block.js' | asset_url }}" defer></script>
{% endif %}

{% schema %}
{
  "name": "UnderItAll Chat Assistant",
  "target": "section",
  "settings": [
    {
      "type": "text",
      "id": "api_url",
      "label": "API Base URL",
      "default": "https://its-under-it-all.replit.app",
      "info": "The base URL for the UnderItAll API"
    },
    {
      "type": "select",
      "id": "position",
      "label": "Position",
      "options": [
        {
          "value": "bottom-right",
          "label": "Bottom Right"
        },
        {
          "value": "bottom-left",
          "label": "Bottom Left"
        }
      ],
      "default": "bottom-right"
    },
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Enable chat assistant",
      "default": true
    }
  ]
}
{% endschema %}